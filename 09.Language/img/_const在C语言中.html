<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>详解C语言中const | HACV</title>
    <meta name="description" content="Personal Blog Website">
    <link rel="icon" href="/images/photo.jpg">
  <link rel="manifest" href="/images/photo.jpg">
  <link rel="apple-touch-icon" href="/images/photo.jpg">
  <meta http-quiv="pragma" cotent="no-cache">
  <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
  <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/assets/css/0.styles.8eb0d87d.css" as="style"><link rel="preload" href="/assets/js/app.55fe0baa.js" as="script"><link rel="preload" href="/assets/js/99.1c372332.js" as="script"><link rel="prefetch" href="/assets/js/10.6c715741.js"><link rel="prefetch" href="/assets/js/100.52dd9baf.js"><link rel="prefetch" href="/assets/js/101.0ec31e5d.js"><link rel="prefetch" href="/assets/js/102.a9e33e5e.js"><link rel="prefetch" href="/assets/js/11.03c97e4e.js"><link rel="prefetch" href="/assets/js/12.dfa489c1.js"><link rel="prefetch" href="/assets/js/13.582089a9.js"><link rel="prefetch" href="/assets/js/14.92cda26d.js"><link rel="prefetch" href="/assets/js/15.8a5be307.js"><link rel="prefetch" href="/assets/js/16.0b214665.js"><link rel="prefetch" href="/assets/js/17.78f67bcf.js"><link rel="prefetch" href="/assets/js/18.513610fb.js"><link rel="prefetch" href="/assets/js/19.98ef82a5.js"><link rel="prefetch" href="/assets/js/2.4d947c59.js"><link rel="prefetch" href="/assets/js/20.c29df3ed.js"><link rel="prefetch" href="/assets/js/21.39ce053b.js"><link rel="prefetch" href="/assets/js/22.b5beee61.js"><link rel="prefetch" href="/assets/js/23.6e7fd055.js"><link rel="prefetch" href="/assets/js/24.cc1406fb.js"><link rel="prefetch" href="/assets/js/25.f74145d3.js"><link rel="prefetch" href="/assets/js/26.9839c339.js"><link rel="prefetch" href="/assets/js/27.915e0f35.js"><link rel="prefetch" href="/assets/js/28.7f985807.js"><link rel="prefetch" href="/assets/js/29.68a37d26.js"><link rel="prefetch" href="/assets/js/3.3fb3d2e0.js"><link rel="prefetch" href="/assets/js/30.32e5b09d.js"><link rel="prefetch" href="/assets/js/31.324b00fd.js"><link rel="prefetch" href="/assets/js/32.8e71514d.js"><link rel="prefetch" href="/assets/js/33.8c516b0e.js"><link rel="prefetch" href="/assets/js/34.67aee3e3.js"><link rel="prefetch" href="/assets/js/35.aec44f16.js"><link rel="prefetch" href="/assets/js/36.b15f2ea0.js"><link rel="prefetch" href="/assets/js/37.c40cf4c2.js"><link rel="prefetch" href="/assets/js/38.5297c5fa.js"><link rel="prefetch" href="/assets/js/39.0ace46bb.js"><link rel="prefetch" href="/assets/js/4.ba66f53b.js"><link rel="prefetch" href="/assets/js/40.fc53401a.js"><link rel="prefetch" href="/assets/js/41.af307c31.js"><link rel="prefetch" href="/assets/js/42.7f800696.js"><link rel="prefetch" href="/assets/js/43.968c95f5.js"><link rel="prefetch" href="/assets/js/44.7a96a8b6.js"><link rel="prefetch" href="/assets/js/45.0dfeb8a2.js"><link rel="prefetch" href="/assets/js/46.f828055c.js"><link rel="prefetch" href="/assets/js/47.e7b243ae.js"><link rel="prefetch" href="/assets/js/48.aece5823.js"><link rel="prefetch" href="/assets/js/49.d65c2de6.js"><link rel="prefetch" href="/assets/js/5.9548bdbb.js"><link rel="prefetch" href="/assets/js/50.60d6dc35.js"><link rel="prefetch" href="/assets/js/51.c8ce8a69.js"><link rel="prefetch" href="/assets/js/52.33d22328.js"><link rel="prefetch" href="/assets/js/53.dec50ab2.js"><link rel="prefetch" href="/assets/js/54.c5ef8d8d.js"><link rel="prefetch" href="/assets/js/55.c2c79fe4.js"><link rel="prefetch" href="/assets/js/56.f971622e.js"><link rel="prefetch" href="/assets/js/57.cffcf419.js"><link rel="prefetch" href="/assets/js/58.0434262c.js"><link rel="prefetch" href="/assets/js/59.86f9bfd1.js"><link rel="prefetch" href="/assets/js/6.30af0bc8.js"><link rel="prefetch" href="/assets/js/60.f8207ce5.js"><link rel="prefetch" href="/assets/js/61.068a8672.js"><link rel="prefetch" href="/assets/js/62.daeb7d00.js"><link rel="prefetch" href="/assets/js/63.bc00694c.js"><link rel="prefetch" href="/assets/js/64.097aa60f.js"><link rel="prefetch" href="/assets/js/65.de9f6fdd.js"><link rel="prefetch" href="/assets/js/66.13530542.js"><link rel="prefetch" href="/assets/js/67.af4337ca.js"><link rel="prefetch" href="/assets/js/68.3221d0b3.js"><link rel="prefetch" href="/assets/js/69.94bc13de.js"><link rel="prefetch" href="/assets/js/7.97fcd6bf.js"><link rel="prefetch" href="/assets/js/70.0b17d9e3.js"><link rel="prefetch" href="/assets/js/71.0320bcba.js"><link rel="prefetch" href="/assets/js/72.355e4cd9.js"><link rel="prefetch" href="/assets/js/73.30bf9e55.js"><link rel="prefetch" href="/assets/js/74.a2492a3b.js"><link rel="prefetch" href="/assets/js/75.ac1937fe.js"><link rel="prefetch" href="/assets/js/76.c4b1b617.js"><link rel="prefetch" href="/assets/js/77.23895ad5.js"><link rel="prefetch" href="/assets/js/78.cd94e8ad.js"><link rel="prefetch" href="/assets/js/79.03c29d47.js"><link rel="prefetch" href="/assets/js/8.45d0f99c.js"><link rel="prefetch" href="/assets/js/80.8bdeccca.js"><link rel="prefetch" href="/assets/js/81.12ec4606.js"><link rel="prefetch" href="/assets/js/82.7e1dc9b9.js"><link rel="prefetch" href="/assets/js/83.0235d3ad.js"><link rel="prefetch" href="/assets/js/84.992b478b.js"><link rel="prefetch" href="/assets/js/85.6dff6467.js"><link rel="prefetch" href="/assets/js/86.57dd451f.js"><link rel="prefetch" href="/assets/js/87.3d217a21.js"><link rel="prefetch" href="/assets/js/88.80ca4ba2.js"><link rel="prefetch" href="/assets/js/89.d1183ec5.js"><link rel="prefetch" href="/assets/js/9.234da0a7.js"><link rel="prefetch" href="/assets/js/90.a4d820e7.js"><link rel="prefetch" href="/assets/js/91.28851db5.js"><link rel="prefetch" href="/assets/js/92.9b194108.js"><link rel="prefetch" href="/assets/js/93.c9b17bc8.js"><link rel="prefetch" href="/assets/js/94.77549315.js"><link rel="prefetch" href="/assets/js/95.100fa452.js"><link rel="prefetch" href="/assets/js/96.566b12dd.js"><link rel="prefetch" href="/assets/js/97.f1953d03.js"><link rel="prefetch" href="/assets/js/98.e4ee72ef.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8eb0d87d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">HACV</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/01.About/" class="nav-link">✡️About</a></div><div class="nav-item"><a href="/02.DataStructureAndAlgorithm/" class="nav-link">🐾数据结构和算法</a></div><div class="nav-item"><a href="/03.OS/" class="nav-link">💻操作系统</a></div><div class="nav-item"><a href="/04.Net/" class="nav-link">☁️网络</a></div><div class="nav-item"><a href="/05.SE/" class="nav-link">☕️软件工程</a></div><div class="nav-item"><a href="/06.SQL/" class="nav-link">💾数据库</a></div><div class="nav-item"><a href="/07.InternalSkill/" class="nav-link">⭐️硬件和编译</a></div><div class="nav-item"><a href="/08.Tools/" class="nav-link">🔧Tools</a></div><div class="nav-item"><a href="/09.Language/" class="nav-link router-link-active">⚛️C/C++</a></div><div class="nav-item"><a href="https://github.com/HACV" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/01.About/" class="nav-link">✡️About</a></div><div class="nav-item"><a href="/02.DataStructureAndAlgorithm/" class="nav-link">🐾数据结构和算法</a></div><div class="nav-item"><a href="/03.OS/" class="nav-link">💻操作系统</a></div><div class="nav-item"><a href="/04.Net/" class="nav-link">☁️网络</a></div><div class="nav-item"><a href="/05.SE/" class="nav-link">☕️软件工程</a></div><div class="nav-item"><a href="/06.SQL/" class="nav-link">💾数据库</a></div><div class="nav-item"><a href="/07.InternalSkill/" class="nav-link">⭐️硬件和编译</a></div><div class="nav-item"><a href="/08.Tools/" class="nav-link">🔧Tools</a></div><div class="nav-item"><a href="/09.Language/" class="nav-link router-link-active">⚛️C/C++</a></div><div class="nav-item"><a href="https://github.com/HACV" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>详解C语言中const</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/09.Language/img/_const%E5%9C%A8C%E8%AF%AD%E8%A8%80%E4%B8%AD.html#一、概述：" class="sidebar-link">一、概述：</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/09.Language/img/_const%E5%9C%A8C%E8%AF%AD%E8%A8%80%E4%B8%AD.html#二、基本用法：" class="sidebar-link">二、基本用法：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/09.Language/img/_const%E5%9C%A8C%E8%AF%AD%E8%A8%80%E4%B8%AD.html#（1）修饰普通变量" class="sidebar-link">（1）修饰普通变量</a></li><li class="sidebar-sub-header"><a href="/09.Language/img/_const%E5%9C%A8C%E8%AF%AD%E8%A8%80%E4%B8%AD.html#（2）修饰数组" class="sidebar-link">（2）修饰数组</a></li><li class="sidebar-sub-header"><a href="/09.Language/img/_const%E5%9C%A8C%E8%AF%AD%E8%A8%80%E4%B8%AD.html#（3）修饰指针（重点）" class="sidebar-link">（3）修饰指针（重点）</a></li><li class="sidebar-sub-header"><a href="/09.Language/img/_const%E5%9C%A8C%E8%AF%AD%E8%A8%80%E4%B8%AD.html#（4）修饰函数形参（重点）" class="sidebar-link">（4）修饰函数形参（重点）</a></li><li class="sidebar-sub-header"><a href="/09.Language/img/_const%E5%9C%A8C%E8%AF%AD%E8%A8%80%E4%B8%AD.html#（5）修饰全局变量" class="sidebar-link">（5）修饰全局变量</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="详解c语言中const"><a href="#详解c语言中const" class="header-anchor">#</a> 详解C语言中const</h1> <p><font color="red" size="4">C语言中的const修饰的变量，叫做<b>常变量</b>（奇怪的名字）</font></p> <h2 id="一、概述："><a href="#一、概述：" class="header-anchor">#</a> 一、概述：</h2> <p>Q：C语言中，const关键字限定一个变量为只读，但它是真正意义上的只读吗？
A：C语言中的并不是的！const虽说是constant的简写，是不变的意思。
但在C语言中，const并不是说它修饰常量，而是说它限定一个变量为只读。</p> <blockquote><ul><li><b>C语言</b>中，const关键字修饰的变量并<b>非真正意义完完全全的只读</b>！</li> <li>（难怪叫<b>常变量</b>,<font color="blue">因为C语言中const就没有把这个变量变成常量！）</font></li></ul></blockquote> <p>Tips：<b>C++</b>中则对const关键字进行了加强，使得真的变成了常量（详情见C++中const详解）
所以，<b>我们常说C++中const修饰的变量，叫做const常量。</b></p> <h2 id="二、基本用法："><a href="#二、基本用法：" class="header-anchor">#</a> 二、基本用法：</h2> <h3 id="（1）修饰普通变量"><a href="#（1）修饰普通变量" class="header-anchor">#</a> （1）修饰普通变量</h3> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">int</span> num <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span> <span class="token comment">//与int const num等价</span>
num <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>  <span class="token comment">//编译错误，不可再次修改</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>DevC++的C语言编译器编译：
[Error] assignment of read-only variable 'NUM'
解释：
由于使用了const修饰NUM，使得NUM为只读，因此尝试对NUM再次赋值的操作是非法的，编译器将会报错。所以，如果需要使用const修饰一个变量，那么它只能在开始声明时就赋值，否则用<b>一般做法</b>在后面就没有机会了（比如，特别的，C语言中可以用指针间接改变）。</p> <h3 id="（2）修饰数组"><a href="#（2）修饰数组" class="header-anchor">#</a> （2）修饰数组</h3> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//使用const关键字修饰数组，使其元素不允许被改变</span>
<span class="token comment">//试图修改arr的内容的操作是非法的，编译器将会报错</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">//与int const arr[]等价</span>
arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">//编译错误</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>DevC++的C语言编译：
[Error] assignment of read-only location 'arr[2]'</p> <h3 id="（3）修饰指针（重点）"><a href="#（3）修饰指针（重点）" class="header-anchor">#</a> （3）修饰指针（重点）</h3> <p>先补充</p> <blockquote><ul><li>下面这两种写法是等效的的！</li></ul> <blockquote><ul><li>const int a=3;</li> <li>int const a=3;</li></ul></blockquote></blockquote> <p>修饰指针的主要有以下几种情况：
1）const 修饰 *p，<b>指向的对象只读</b>，指针的指向可变:</p> <blockquote><ul><li>常量指针——指向常量的指针，顾名思义，就是指针指向的是常量，即它不能指向变量，它指向的内容不能被改变，不能通过指针来修改它指向的内容，但是指针自身不是常量，它自身的值可以改变，从而指向另一个常量。</li></ul></blockquote> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span><span class="token comment">//p是一个指向int类型的const值,与int const *p等价</span>
<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>    <span class="token comment">//编译错误，指向的对象是只读的，不可通过p进行改变</span>
p <span class="token operator">=</span> <span class="token operator">&amp;</span>b<span class="token punctuation">;</span>     <span class="token comment">//合法，改变了p的指向</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>换句话说更加准确：指针P是指向const int *</p> <p>这里为了便于理解，可认为const修饰的是<em>p，通常使用</em>对指针进行解引用来访问对象，因而该对象是只读的。</p> <p><font color="red" size="5">（此处补充——《C专家编程》书中的一段）</font></p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span>cp<span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>Ccp<span class="token punctuation">;</span>
ccp <span class="token operator">=</span> Cp<span class="token punctuation">;</span>
<span class="token comment">//左操作数是一个指向有const限定符的char的指针。</span>
<span class="token comment">//右操作数是一个指向没有限定符的char的指针。</span>
<span class="token comment">//char类型与char类型是相容的，左操作数所指向的类型具有右操作数所指向类型的限定符(无)，再加上自身的限定符(const)。</span>
<span class="token comment">//注意，反过来就不能进行赋值。试试下而的代码:</span>
cp <span class="token operator">=</span> ccp<span class="token punctuation">;</span>
<span class="token comment">/*结果产生编译警告*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>解释：</p> <blockquote><ul><li>const char *ccp;//表示我保证，我不会去改变我指向的那个对象</li> <li>char *cp;//表示我可以改变我指向的那个对象</li> <li>我们可以，想想一下一个场景来理解ccp和cp的相互赋值的合法性</li></ul> <blockquote><ul><li>ccp=cp;//表示，cp告诉ccp说，我给你的对象，我可以改变，我赋值给你，你要是想改也可以。ccp说,我是有原则的，我的原则就是，我不会去改变我指向的那个对象（相容），ccp说，行，随你。</li> <li>cp=ccp;//表示，ccp告诉cp，我给你的对象，我可舍不得改了，我赋值给你，你可不能改，ccp说，我也是有原则的，我就要改，而它一改，编译器就阻止它说，你这样不行，侵犯了ccp的原则。</li></ul></blockquote></blockquote> <ol start="2"><li>const修饰p，指向的对象可变，<b>指针的指向不可变</b>：</li></ol> <blockquote><ul><li>指针常量——指针本身是常量。它指向的地址是不可改变的，但地址里的内容可以通过指针改变。它指向的地址将伴其一生，直到生命周期结束。有一点需要注意的是，指针常量在定义时必须同时赋初值。</li></ul></blockquote> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span><span class="token comment">//p是一个const指针</span>
<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>    <span class="token comment">//合法，</span>
p <span class="token operator">=</span> <span class="token operator">&amp;</span>b<span class="token punctuation">;</span>     <span class="token comment">//编译错误，p是一个const指针，只读，不可变</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ol start="3"><li>指针不可改变指向，指向的内容也不可变</li></ol> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> b <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> <span class="token operator">*</span> <span class="token keyword">const</span> p <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span><span class="token comment">//p既是一个const指针，同时也指向了int类型的const值</span>
<span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span>    <span class="token comment">//编译错误，指向的对象是只读的，不可通过p进行改变</span>
p <span class="token operator">=</span> <span class="token operator">&amp;</span>b<span class="token punctuation">;</span>     <span class="token comment">//编译错误，p是一个const指针，只读，不可变</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>小结：
const放在<em>的左侧，限定了该指针指向的对象是只读的；
const放在</em>的右侧，限定了指针本身是只读的，即不可变的。</p> <table><td bgcolor="#FFFF">
记忆法：
const右边修饰谁，就说明谁是不可变的</td></table> <p>解释：</p> <blockquote><ul><li>首先我们去掉类型说明符，查看const右边修饰的内容，上面三种情况去掉类型说明符int之后，如下：</li> <li>const <em>p; //修饰</em>p，指针指向的对象不可变</li> <li>* const p; //修饰p，指针不可变</li> <li>const * const p; //第一个修饰了*p，第二个修饰了p，两者都不可变</li> <li>此外，这种记忆法，还能帮助记忆先前那两个等价的形式：</li></ul> <blockquote><ul><li>const int NUM = 10; 	//与int const NUM等价</li> <li>const int *p  = &amp;a;		//与int const *p等价</li> <li>const int arr[] = {0,0,2,3,4}; 	//与int const arr[]等价</li></ul></blockquote></blockquote> <h3 id="（4）修饰函数形参（重点）"><a href="#（4）修饰函数形参（重点）" class="header-anchor">#</a> （4）修饰函数形参（重点）</h3> <p><b>（重点，在函数接口，控制指针只做输入/<em>in</em>/）</b></p> <p>实际上，为我们可以经常发现const关键字的身影，例如很多库函数的声明：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">char</span> <span class="token operator">*</span> <span class="token function">strncpy</span><span class="token punctuation">(</span><span class="token keyword">char</span> <span class="token operator">*</span>dest<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>src<span class="token punctuation">,</span> <span class="token class-name">size_t</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字符串拷贝函数</span>
<span class="token keyword">int</span>  <span class="token operator">*</span> <span class="token function">strncmp</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>s1<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>s2<span class="token punctuation">,</span> <span class="token class-name">size_t</span> n<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//字符串比较函数</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>观察一个例子：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//test.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">void</span> <span class="token function">myPrint</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">void</span> <span class="token function">myPrint</span><span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>str<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'H'</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;my print:%s\n&quot;</span><span class="token punctuation">,</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">char</span> str<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;hello world&quot;</span><span class="token punctuation">;</span>
    <span class="token function">myPrint</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>此例子中，我们不希望myPrint函数修改传入的字符串内容，因此入参使用了const限定符，表明传入的字符串是只读的，因此，如果myPrint函数内部如果尝试对str进行修改，将会报错:
error: assignment of read-only location ‘*str’str[0] = 'H';</p> <p><b>工程常用做法</b>：</p> <blockquote><ul><li>我们在编码过程中，如果确定传入的指针参数仅用于访问数据，那么应该将其声明为一个指向const限定类型的指针，避免函数内部对数据进行意外地修改!!!</li></ul></blockquote> <h3 id="（5）修饰全局变量"><a href="#（5）修饰全局变量" class="header-anchor">#</a> （5）修饰全局变量</h3> <p>我们知道，使用全局变量是一种不安全的做法，因为程序的任何部分都能够对全局数据进行修改。而如果对全局变量增加const限定符（假设该全局数据不希望被修改），就可以避免被程序其他部分修改。这里有两种使用方式。
1）第一种，在a文件中定义，其他文件中使用外部声明，例如：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//a.h</span>
<span class="token keyword">const</span> <span class="token keyword">int</span> ARR<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">//定义int数组</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//b.c</span>
<span class="token keyword">extern</span> <span class="token keyword">const</span> <span class="token keyword">int</span> ARR<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>   <span class="token comment">//注意，这里不能再对ARR进行赋值</span>
<span class="token comment">//后面可以使用ARR</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>2）第二种，在a文件中定义，并使用static修饰，b文件包含a文件，例如：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//a.h</span>
<span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">int</span> ARR<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">}</span><span class="token punctuation">;</span>  <span class="token comment">//定义int数组</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">//b.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;a.h&gt;</span></span>
<span class="token comment">//后面可以使用ARR</span>
注意，这里必须使用<span class="token keyword">static</span>修饰，否则多个文件包含导致编译会出现重复定义的错误。可以尝试一下。（为什么？因为，<span class="token keyword">static</span>修饰的变量，要是初始化了是放在<span class="token punctuation">.</span>data段的，而不是栈区）
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><table><td bgcolor="#FFFF" FF>
易错点：
Q：C语言中const修饰的变量是真正的只读吗？
A：C语言const修饰的变量，可以被间接修改！
</td></table> <p>在C语言中，const变量只不过是修饰该变量名，它并不能使内存变为只读。也就是说，我们不能通过变量名再去操作这块内存。但是可以通过其它方法，如指针，通过指针是可以修改被const修饰的那块内存的。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">int</span> a <span class="token operator">=</span> <span class="token number">2018</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token operator">&amp;</span>a<span class="token punctuation">;</span>
    <span class="token operator">*</span>p <span class="token operator">=</span> <span class="token number">2019</span><span class="token punctuation">;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>DevC++虽然有一个警告：
[Warning] initialization discards 'const' qualifier from pointer target type
（[警告]初始化会从指针目标类型中丢弃'const'限定符）
但是还是可以修改！！！
可以看到，我们通过另外定义一个指针变量，将被const修饰的a的值改变了。	
此外，对于由于像数组溢出，隐式修改等程序不规范书写造成的运行过程中的修改，编译器是无能为力的，也说明const修饰的变量仍然是具备变量属性的。</p> <p>我们要知道的是，const关键字告诉了编译器，它修饰的变量不能被改变，如果代码中发现有类似改变该变量的操作，那么编译器就会捕捉这个错误。</p> <p>那么它在<b>实际中的意义之一</b>是什么呢？
帮助程序员提前发现问题，避免不该修改的值被意外地修改，但是无法完全保证不被修改！
也就是说，C语言中<b>const关键字是给编译器用的</b>帮助程序员提早发现可能存在的问题。
（所以给了个warning？但是却不给error，也是够了。）</p> <p>从这次的分析中，我们可以获得的思考：
1）<b>不要忽略编译器的警告，除非你很清楚在做什么</b>。（比如，上面我们用那些方法修改了const修饰的。）
2）虽然可以通过某种不正规途径修改const修饰的变量，但是在<b>工程中</b>永远不要这么做。
3）const关键字让编译器帮助我们发现变量不该被修改却被意外修改的错误。</p> <p><font color="red" size="5">常见的问题：</font>
C语言中:</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> test<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//[Error] variably modified 'aa' at file scope</span>

<span class="token keyword">const</span> <span class="token keyword">int</span> maxn<span class="token operator">=</span><span class="token number">1000</span><span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">;</span>
<span class="token keyword">int</span> test<span class="token punctuation">[</span>maxn<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">//编译出错，[Error] variably modified 'test' at file scope</span>
<span class="token comment">//在文件范围内可变地修改了“test”，因为数组的下标只接受常量，而C语言中const修饰的变量是个“假的常量”</span>
<span class="token comment">//当然，上面语法在Ｃ＋＋中是可以的，因为C++对C语言中const关键字进行了加强，使得真的是常量了，</span>
<span class="token comment">//而且，在C++中，还给const修饰而形成的常量，取名叫做const常量。</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.55fe0baa.js" defer></script><script src="/assets/js/99.1c372332.js" defer></script>
  </body>
</html>
