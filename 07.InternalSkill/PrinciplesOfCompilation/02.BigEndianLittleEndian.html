<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>格列夫游记的鸡蛋—大小端之争 | HACV</title>
    <meta name="description" content="Personal Blog Website">
    <link rel="icon" href="/images/photo.jpg">
  <link rel="manifest" href="/images/photo.jpg">
  <link rel="apple-touch-icon" href="/images/photo.jpg">
  <meta http-quiv="pragma" cotent="no-cache">
  <meta http-quiv="pragma" cotent="no-cache,must-revalidate">
  <meta http-quiv="expires" cotent="0">
    
    <link rel="preload" href="/assets/css/0.styles.8eb0d87d.css" as="style"><link rel="preload" href="/assets/js/app.cf4884d5.js" as="script"><link rel="preload" href="/assets/js/69.b1534824.js" as="script"><link rel="prefetch" href="/assets/js/10.4db3c68d.js"><link rel="prefetch" href="/assets/js/11.9d992966.js"><link rel="prefetch" href="/assets/js/12.bee4e0cc.js"><link rel="prefetch" href="/assets/js/13.b63fb17d.js"><link rel="prefetch" href="/assets/js/14.46bc4a2f.js"><link rel="prefetch" href="/assets/js/15.c79a7600.js"><link rel="prefetch" href="/assets/js/16.782913d6.js"><link rel="prefetch" href="/assets/js/17.52a4b387.js"><link rel="prefetch" href="/assets/js/18.63457332.js"><link rel="prefetch" href="/assets/js/19.16bb3f47.js"><link rel="prefetch" href="/assets/js/2.7f166cfd.js"><link rel="prefetch" href="/assets/js/20.abcc0d3b.js"><link rel="prefetch" href="/assets/js/21.165f0dce.js"><link rel="prefetch" href="/assets/js/22.17ae9290.js"><link rel="prefetch" href="/assets/js/23.84ef6427.js"><link rel="prefetch" href="/assets/js/24.ccb0ab4a.js"><link rel="prefetch" href="/assets/js/25.04a41720.js"><link rel="prefetch" href="/assets/js/26.6907eb7a.js"><link rel="prefetch" href="/assets/js/27.62028a2f.js"><link rel="prefetch" href="/assets/js/28.94be10e8.js"><link rel="prefetch" href="/assets/js/29.bff94161.js"><link rel="prefetch" href="/assets/js/3.1e4788e6.js"><link rel="prefetch" href="/assets/js/30.d3a9e3e4.js"><link rel="prefetch" href="/assets/js/31.4feaff59.js"><link rel="prefetch" href="/assets/js/32.10952825.js"><link rel="prefetch" href="/assets/js/33.2739f74d.js"><link rel="prefetch" href="/assets/js/34.a72187e7.js"><link rel="prefetch" href="/assets/js/35.470badb8.js"><link rel="prefetch" href="/assets/js/36.f34f85a5.js"><link rel="prefetch" href="/assets/js/37.f61402c1.js"><link rel="prefetch" href="/assets/js/38.b87b554d.js"><link rel="prefetch" href="/assets/js/39.15dee6dd.js"><link rel="prefetch" href="/assets/js/4.a1884607.js"><link rel="prefetch" href="/assets/js/40.96b5f618.js"><link rel="prefetch" href="/assets/js/41.48790787.js"><link rel="prefetch" href="/assets/js/42.0b5de3dd.js"><link rel="prefetch" href="/assets/js/43.ec8dc756.js"><link rel="prefetch" href="/assets/js/44.bd009280.js"><link rel="prefetch" href="/assets/js/45.02cc1fd7.js"><link rel="prefetch" href="/assets/js/46.167dc4c3.js"><link rel="prefetch" href="/assets/js/47.b3bc9385.js"><link rel="prefetch" href="/assets/js/48.164282a2.js"><link rel="prefetch" href="/assets/js/49.f5f02b3f.js"><link rel="prefetch" href="/assets/js/5.40f5e637.js"><link rel="prefetch" href="/assets/js/50.e53fbe6e.js"><link rel="prefetch" href="/assets/js/51.5cb5781d.js"><link rel="prefetch" href="/assets/js/52.f18b8cd4.js"><link rel="prefetch" href="/assets/js/53.a9560aa6.js"><link rel="prefetch" href="/assets/js/54.799efed6.js"><link rel="prefetch" href="/assets/js/55.06698846.js"><link rel="prefetch" href="/assets/js/56.27b64fea.js"><link rel="prefetch" href="/assets/js/57.232eb287.js"><link rel="prefetch" href="/assets/js/58.b2b684f9.js"><link rel="prefetch" href="/assets/js/59.14d3c809.js"><link rel="prefetch" href="/assets/js/6.bf64a6c1.js"><link rel="prefetch" href="/assets/js/60.5a0e3576.js"><link rel="prefetch" href="/assets/js/61.d8499800.js"><link rel="prefetch" href="/assets/js/62.480ea62a.js"><link rel="prefetch" href="/assets/js/63.82326be3.js"><link rel="prefetch" href="/assets/js/64.b8b139ad.js"><link rel="prefetch" href="/assets/js/65.240377e4.js"><link rel="prefetch" href="/assets/js/66.dfaa966b.js"><link rel="prefetch" href="/assets/js/67.2ebc9495.js"><link rel="prefetch" href="/assets/js/68.1685fc03.js"><link rel="prefetch" href="/assets/js/7.1e7f51d7.js"><link rel="prefetch" href="/assets/js/70.cb13bb92.js"><link rel="prefetch" href="/assets/js/71.853d3c71.js"><link rel="prefetch" href="/assets/js/72.6e3ecd09.js"><link rel="prefetch" href="/assets/js/73.54f2912b.js"><link rel="prefetch" href="/assets/js/74.8e5a6f81.js"><link rel="prefetch" href="/assets/js/75.80ed6096.js"><link rel="prefetch" href="/assets/js/76.59085aa9.js"><link rel="prefetch" href="/assets/js/77.f4051492.js"><link rel="prefetch" href="/assets/js/78.7d344114.js"><link rel="prefetch" href="/assets/js/79.78278e76.js"><link rel="prefetch" href="/assets/js/8.7a24a1a0.js"><link rel="prefetch" href="/assets/js/80.9e6694a2.js"><link rel="prefetch" href="/assets/js/81.6de352b9.js"><link rel="prefetch" href="/assets/js/82.9f6ae5ae.js"><link rel="prefetch" href="/assets/js/83.3f168286.js"><link rel="prefetch" href="/assets/js/84.17bf84f6.js"><link rel="prefetch" href="/assets/js/85.2bee383d.js"><link rel="prefetch" href="/assets/js/86.b44b1eef.js"><link rel="prefetch" href="/assets/js/87.f2d6ba11.js"><link rel="prefetch" href="/assets/js/88.e3b46c07.js"><link rel="prefetch" href="/assets/js/89.acf868f9.js"><link rel="prefetch" href="/assets/js/9.dd273779.js"><link rel="prefetch" href="/assets/js/90.385de6b4.js"><link rel="prefetch" href="/assets/js/91.3898f586.js"><link rel="prefetch" href="/assets/js/92.55adc306.js"><link rel="prefetch" href="/assets/js/93.3e95635e.js"><link rel="prefetch" href="/assets/js/94.beb2e400.js"><link rel="prefetch" href="/assets/js/95.103118ce.js"><link rel="prefetch" href="/assets/js/96.c325ee02.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8eb0d87d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">HACV</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/01.About/" class="nav-link">✡️About</a></div><div class="nav-item"><a href="/02.DataStructureAndAlgorithm/" class="nav-link">🐾数据结构和算法</a></div><div class="nav-item"><a href="/03.OS/" class="nav-link">💻操作系统</a></div><div class="nav-item"><a href="/04.Net/" class="nav-link">☁️网络</a></div><div class="nav-item"><a href="/05.SE/" class="nav-link">☕️软件工程</a></div><div class="nav-item"><a href="/06.SQL/" class="nav-link">💾数据库</a></div><div class="nav-item"><a href="/07.InternalSkill/" class="nav-link router-link-active">⭐️硬件和编译</a></div><div class="nav-item"><a href="/08.Tools/" class="nav-link">🔧Tools</a></div><div class="nav-item"><a href="/09.Language/" class="nav-link">⚛️C/C++</a></div><div class="nav-item"><a href="https://github.com/HACV" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/01.About/" class="nav-link">✡️About</a></div><div class="nav-item"><a href="/02.DataStructureAndAlgorithm/" class="nav-link">🐾数据结构和算法</a></div><div class="nav-item"><a href="/03.OS/" class="nav-link">💻操作系统</a></div><div class="nav-item"><a href="/04.Net/" class="nav-link">☁️网络</a></div><div class="nav-item"><a href="/05.SE/" class="nav-link">☕️软件工程</a></div><div class="nav-item"><a href="/06.SQL/" class="nav-link">💾数据库</a></div><div class="nav-item"><a href="/07.InternalSkill/" class="nav-link router-link-active">⭐️硬件和编译</a></div><div class="nav-item"><a href="/08.Tools/" class="nav-link">🔧Tools</a></div><div class="nav-item"><a href="/09.Language/" class="nav-link">⚛️C/C++</a></div><div class="nav-item"><a href="https://github.com/HACV" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>格列夫游记的鸡蛋—大小端之争</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/07.InternalSkill/PrinciplesOfCompilation/02.BigEndianLittleEndian.html#引子：" class="sidebar-link">引子：</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/07.InternalSkill/PrinciplesOfCompilation/02.BigEndianLittleEndian.html#一．概念" class="sidebar-link">一．概念</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/07.InternalSkill/PrinciplesOfCompilation/02.BigEndianLittleEndian.html#二．具体的，大端法和小端法的应用" class="sidebar-link">二．具体的，大端法和小端法的应用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/07.InternalSkill/PrinciplesOfCompilation/02.BigEndianLittleEndian.html#三．大端法和小端法导致的问题：" class="sidebar-link">三．大端法和小端法导致的问题：</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/07.InternalSkill/PrinciplesOfCompilation/02.BigEndianLittleEndian.html#_1）网络应用程序数据传输" class="sidebar-link">1）网络应用程序数据传输</a></li><li class="sidebar-sub-header"><a href="/07.InternalSkill/PrinciplesOfCompilation/02.BigEndianLittleEndian.html#_2）反汇编的时候" class="sidebar-link">2）反汇编的时候</a></li></ul></li><li><a href="/07.InternalSkill/PrinciplesOfCompilation/02.BigEndianLittleEndian.html#四．如何判别大端和小端" class="sidebar-link">四．如何判别大端和小端</a><ul class="sidebar-sub-headers"></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="格列夫游记的鸡蛋—大小端之争"><a href="#格列夫游记的鸡蛋—大小端之争" class="header-anchor">#</a> 格列夫游记的鸡蛋—大小端之争</h1> <p>大端和小端存储
date: 2020-05-29 19:53:47</p> <h2 id="引子："><a href="#引子：" class="header-anchor">#</a> <strong>引子</strong>：</h2> <p>《格列夫游记》一书中讲到，格列佛在小人国中，遇到了这样一件事情：</p> <div class="language-txt line-numbers-mode"><pre class="language-text"><code>小人国的人纠结于吃鸡蛋的时候，先打破鸡蛋的小端还大端，原来，在这之前所有人都认为,吃鸡蛋前,原始的方法是打破鸡蛋较大的一端。可是当今皇帝的祖父小时候吃鸡蛋,一次按古法打鸡蛋时碰巧将一个手指弄破了,因此他的父亲,当时的皇帝，就下了一道敕令,命令全体臣民吃鸡蛋时打破鸡蛋较小的一端,违令者重罚。老百姓们对这项命令极为反感。历史告诉我们，由此曾发生过六次叛乱,其中一个皇帝送了命,另一个丢了王位。关于这一争端,曾出版过几百本大部著作,不过大端派的书一直是受禁的,法律也规定该派的任何人不得做官。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在计算机界，也有一个类似的大端小端之争，但是并没有像小人国那般，原先我们虽然在纠结选大端还是小端存储？但是随着计算机的发展，历史告诉我们，这些都是合理的，但是要在计算机间合理通信或者理解计算机底层的时候，你自己记得转换就好了。</p> <h1 id="大端和小端存储"><a href="#大端和小端存储" class="header-anchor">#</a> 大端和小端存储</h1> <h2 id="一．概念"><a href="#一．概念" class="header-anchor">#</a> 一．概念</h2> <p>大端：指低字节存储在高地址。
小端：指低字节存储在低地址。</p> <p><strong>记忆方法：</strong> <table><td bgcolor="#FFFF" FF>小端说：我就是个低低（弟弟）</td></table></p> <p>下图描述了——大端存储（低字节存储在内存高地址了）：
<img src="/photos/2020.5.29/1.png" width="80%"></p> <p>下图描述了——小端存储（低字节存储在内存低地址了）：：
<img src="/photos/2020.5.29/2.png" width="80%"></p> <h2 id="二．具体的，大端法和小端法的应用"><a href="#二．具体的，大端法和小端法的应用" class="header-anchor">#</a> 二．具体的，大端法和小端法的应用</h2> <p>有的产品用的大端法，有的产品则是小端法。
PS:这个大端和小端并没有严格按照企业界限来区分，因为有的企业，它在之前采用的处理器，可能是大端，但是后面的产品中改变了采用的处理器，可能就采用小端法了。
前沿：许多比较新的微处理器使用双端法，也就是说可以把它们配置成作为大端或者小端的机器运行。</p> <h2 id="三．大端法和小端法导致的问题："><a href="#三．大端法和小端法导致的问题：" class="header-anchor">#</a> 三．大端法和小端法导致的问题：</h2> <h3 id="_1）网络应用程序数据传输"><a href="#_1）网络应用程序数据传输" class="header-anchor">#</a> 1）网络应用程序数据传输</h3> <p>在采用不同大小端存储的机器之间通过网络传送二进制数据时候，会导致采用不同大小端存储方式的数据的字节变成反序。
解决方案：网络应用程序的代码编写，必须遵循已建立的关于字节顺序的规则（第一处：网络传输规定了，网络字节序（它采用的大端））。
第2处，你的机器发送报文前，需要将你的内部表达转换成网络标准。
第3处，你的机器接受报文时候，需要根据你的机器，将网络标准转换为你的内部表示。。</p> <p>网络字节序
网络上传输的数据都是字节流,对于一个多字节数值，在进行网络传输的时候,先传递哪个字节?也就是说,当接收端收到第一个字节的时候,它将这个字节作为高位字节还是低位字节处理,是一个比较有意义的问题;
UDP/TCP/IP协议规定:
把接收到的第一个字节当作高位字节看待,这就要求发送端发送的第一个字节是高位字节;</p> <p>而在发送端发送数据时，发送的第一个字节是该数值在内存中的起始地址处对应的那个字节,也就是说,该数值在内存中的起始地址处对应的那个字节就是要发送的第一个高位字节(即:高位字节存放在低地址处);
由此可见,多字节数值在发送之前,在内存中因该是以大端法存放的;所以说,网络字节序是大端字节序;</p> <p>比如,我们经过网络发送整型数值0x12345678时,在80x86平台中,它是以小端发存放的,在发送之前需要使用系统提供的字节序转换函数将其转换成大端法存放的数值;</p> <p>常见CPU的宇节序
大端（big Endian）: PowerPC、IBM、 Sun
小端（little Endian）:x86、DEC
ARM既可以工作在大端模式,也可以工作在小端模式。</p> <h3 id="_2）反汇编的时候"><a href="#_2）反汇编的时候" class="header-anchor">#</a> 2）反汇编的时候</h3> <table><tr><td bgcolor="#FFFF" FF>（——————未完待续）</td></tr></table> <h2 id="四．如何判别大端和小端"><a href="#四．如何判别大端和小端" class="header-anchor">#</a> 四．如何判别大端和小端</h2> <p>1）我们可以根据C语言中的，联合体来判断，该系统是大端还是小端。
因为，联合体变量总是从低地址存储。</p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span><span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token keyword">union</span> test
	<span class="token punctuation">{</span>
		<span class="token keyword">int</span> a<span class="token punctuation">;</span>
		<span class="token keyword">char</span> c<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>demo<span class="token punctuation">;</span>
	
	demo<span class="token punctuation">.</span>a<span class="token operator">=</span><span class="token number">0x01ffff03</span><span class="token punctuation">;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d&quot;</span><span class="token punctuation">,</span>demo<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0x03</span><span class="token operator">==</span>demo<span class="token punctuation">.</span>c<span class="token punctuation">)</span> 
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;这个机器是小端存储！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token number">0x00</span><span class="token operator">==</span>demo<span class="token punctuation">.</span>c<span class="token punctuation">)</span> 
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;这个机器是大端存储！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">else</span>
	<span class="token punctuation">{</span>
		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;无法判断机器类型！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>显然，
要是小端存储，那么（低字节）0x03在低地址，
要是大端存储，那么（高字节）0x00在低地址。
所以，打印出3就是小端存储。打印出0那就是大端存储。
笔者的电脑是采用的intel的X86CPU，是小端存储。
<img src="/photos/2020.5.29/3.png" width="80%"></p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.cf4884d5.js" defer></script><script src="/assets/js/69.b1534824.js" defer></script>
  </body>
</html>
